(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{528:function(e,t,n){},546:function(e,t,n){"use strict";n.r(t);var r=n(69),i=n.n(r),o=n(1),a=n.n(o),s=n(62),c=n.n(s),l=n(70),u=n(16),d=n(3),f=n(197),p=n(5),g=n(17),h=n(89);function m(e){var t=Object(l.a)(strings.settings),n=a()("div",{className:"main list"});actionStack.push({id:"settings-theme",action:t.hide}),t.onhide=function(){actionStack.remove("settings-theme")};var r=appSettings.value,i=[{key:"sort",text:strings["sort by name"],subText:"on"===r.fileBrowser.sortByName?strings.yes:strings.no},{key:"show",text:strings["show hidden files"],subText:"on"===r.fileBrowser.showHiddenFiles?strings.yes:strings.no}];h.a.listItems(n,i,(function(){var t=this;switch(this.key){case"sort":p.a.select(strings["sort by name"],[["on",strings.yes],["off",strings.no]],{default:r.fileBrowser.sortByName}).then((function(n){appSettings.value.fileBrowser.sortByName=n,appSettings.update(),t.changeSubText("on"===r.fileBrowser.sortByName?strings.yes:strings.no),e&&e()}));break;case"show":p.a.select(strings["show hidden files"],[["on",strings.yes],["off",strings.no]],{default:r.fileBrowser.showHiddenFiles}).then((function(n){appSettings.value.fileBrowser.showHiddenFiles=n,appSettings.update(),t.changeSubText("on"===r.fileBrowser.showHiddenFiles?strings.yes:strings.no),e&&e()}))}})),t.appendChild(n),document.body.append(t)}n(528);var v=n(139),b=n(55),w=n(198),y={angular:function(){return n.e(1).then(n.bind(null,540))},angularjs:function(){return n.e(2).then(n.bind(null,541))},html:function(){return n.e(10).then(n.bind(null,542))},react:function(){return n.e(12).then(n.bind(null,543))},vue:function(){return n.e(17).then(n.bind(null,544))}};t.default=function(e,t,n){e||(e="file"),!n&&localStorage.lastDir&&(n=localStorage.lastDir);var r=window.actionStack,o=p.a.prompt;return new Promise((function(n,s){var h,S=a()("i",{className:"icon more_vert",attr:{action:"toggle-menu"}}),x=a()("i",{className:"icon add disabled",attr:{action:"toggle-add-menu"}}),k=a()("i",{className:"icon search",attr:{action:"search"}}),L=Object(l.a)("File Browser"),j=a.a.parse(c.a.render('<div tabindex="-1" class="main" id="file-browser" type="{{type}}">\n  <div class="navigation" tabindex="-1"></div>\n</div>',{type:e})),B=j.querySelector(".navigation"),E=[],D={top:"8px",right:"8px",toggle:S,transformOrigin:"top right"},F=Object(f.a)('<li action="settings">'.concat(strings.settings,"</li>"),D),O=Object(f.a)(c.a.render('<li action="create" value="file">{{new file}}</li>\n<li action="create" value="folder">{{new folder}}</li>\n<li action="create" value="project">{{new project}}</li>',strings),(D.toggle=x)&&D),N="file:///storage/",A={},I={url:N,name:"File browser"};if(j.addEventListener("click",H),j.addEventListener("contextmenu",C),L.append(j),L.querySelector("header").append(k,x,S),document.body.append(L),r.push({id:"filebrowser",action:function(){s({error:"user canceled",code:0}),L.hide()}}),F.onclick=function(e){F.hide();var t=e.target.getAttribute("action");t&&"settings"===t&&m(P)},O.onclick=function(e){O.hide();var t=e.target.getAttribute("action"),n=e.target.getAttribute("value");t&&"create"===t&&function(e){var t=I.url,n=I.name;if("file"===e||"folder"===e){var r=strings["enter folder name"],i=strings["new folder"];"file"===e&&(r=strings["enter file name"],i="untitiled.txt"),o(r,i,"filename",{match:g.a.FILE_NAME_REGEX,required:!0}).then((function(r){r&&(r=d.a.removeLineBreaks(r),Object(b.a)(t).then((function(t){return"folder"===e?t.createDirectory(r):"file"===e?t.createFile(r):void 0})).then((function(){G(t),window.plugins.toast.showLongBottom(strings.success),_(t,n)})).catch((function(e){d.a.error(e,t,"filename: "+r),console.error(e)})))}))}else if("project"===e){var a=[],s=[],c="",l="",u=null,f="",h="";Object.keys(y).map((function(e){a.push([e,e,"icon "+e])})),p.a.select(strings["new project"],a).then((function(e){return h=e,p.a.loaderShow(e,strings.loading+"..."),y[e]()})).then((function(e){return p.a.loaderHide(),c=e.default,p.a.prompt(strings["project name"],h,"text",{required:!0,match:g.a.FILE_NAME_REGEX})})).then((function(e){return f=e,Object(b.a)(t)})).then((function(e){return p.a.loaderShow(f,strings.loading+"..."),e.createDirectory(f)})).then((function(e){u=t+f+"/";var r=Object.keys(c);return new Promise((function(e,i){!function e(i,o){r.length||(G(t),window.plugins.toast.showLongBottom(strings.success),_(t,n),i());var a=r.pop();l=[],(d=a,p=d.split("/"),g=p.pop(),new Promise((function(e,t){!function n(){var r=u+l;if(0===p.length)return Object(b.a)(r).then((function(e){var t=c[d].replace(/<%name%>/g,f);return e.createFile(g,t)})).then(e).catch(t);var i=p.splice(0,1)[0],o=r+i;Object(b.a)(r).then((function(e){return s.includes(o)?Promise.resolve():e.createDirectory(i)})).then((function(e){return s.includes(o)||s.push(o),l+=i+"/",n(p)})).catch(t)}()}))).then((function(){e(i,o)})).catch(o);var d,p,g}(e,i)}))})).catch((function(e){d.a.error(e),console.error(e)})).finally((function(){p.a.loaderHide()}))}}(n)},k.onclick=function(){var e=j.get("#list");e&&Object(w.a)(e)},L.onhide=function(){for(var e="";e=E.pop();)r.remove(e);r.remove("filebrowser"),j.removeEventListener("click",H),j.removeEventListener("contextmenu",C)},"folder"===e){var R=a()("button",{textContent:t||strings["select folder"]});h=a()("footer",{className:"button-container",child:R}),L.setAttribute("footer-height",1),L.append(h),R.onclick=function(){L.hide(),T(I)}}function T(e){localStorage.setItem("lastDir",I.url),n(e)}function q(t){cordova.plugins.diagnostic.getExternalSdCardDetails((function(n){var r=[];n.length>0&&n.map((function(e){var n=e.path.split("/").splice(-1)[0],i=e.filePath+"/";return"files"===n||r.push({name:t&&t[n]?t[n]:n,nativeURL:i,origin:i,isDirectory:!0,parent:!0,type:"folder"}),e}));var i=cordova.file.externalRootDirectory;r.push({nativeURL:i,name:"Internal storage",isDirectory:!0,parent:!0,type:"folder"}),"file"===e&&r.push({name:"Select document",isDirectory:!0,type:"folder","open-doc":!0}),A[N]={name:name,list:r},U("/",N),J(r),"folder"===e&&h.classList.add("disabled")}))}function _(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:N,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"File Browser",o=t;if("object"===i()(t)&&(o=t.url,n=t.name),o in A){l();var s=A[o];J(s.list);var c=a.a.get("#list");c.scrollTop=s.scroll,n=s.name}else u.a.listDir(o).then((function(e){l(),e=d.a.sortDir(e,appSettings.value.fileBrowser),A[o]={name:n,list:e},J(e)})).catch((function(e){r.remove(I.url),d.a.error(e,o),console.error(e)}));function l(){"folder"===e&&(o===N?(x.classList.add("disabled"),h.classList.add("disabled")):(x.classList.remove("disabled"),h.classList.remove("disabled"))),I.url=o,I.name=n;var t=a.a.get("#list");t&&(t.scrollTop=0),U(n,o),L.settitle(n)}}function H(e,n){var i=e.target,o=i.getAttribute("action");if(o){var s=i.getAttribute("url"),c=i.getAttribute("name");switch(i.getAttribute("open-doc")&&(o="open-doc"),o){case"navigation":case"folder":!function(){if("contextmenu"!==n){var e=I.url,t=JSON.parse(JSON.stringify(I));A[e].scroll=a.a.get("#list").scrollTop,E.push(e),r.push({id:e,action:function(){E.pop(),_(t),"folder"===o&&U.pop()}}),_(s,c)}else l()}();break;case"file":"contextmenu"!==n?"function"==typeof t&&t(c)&&(L.hide(),T({url:s})):l();break;case"open-doc":SDcard.openDoc((function(e){e.isContentUri=!0,e.url=e.uri,T(e),L.hide()}),(function(e){d.a.error(e),console.error(e)}))}}function l(){navigator.vibrate(50),p.a.select("",[["delete",strings.delete,"delete"],["rename",strings.rename,"edit"]]).then((function(e){switch(e){case"delete":p.a.confirm(strings["delete {name}"].replace("{name}",c)).then(u);break;case"rename":p.a.prompt(strings.rename,c,"text",{match:g.a.FILE_NAME_REGEX}).then((function(e){!function(e){Object(b.a)(s).then((function(t){return t.renameTo(e)})).then((function(){G(s),window.plugins.toast.showShortBottom(strings.success),_(I)})).catch((function(e){d.a.error(e),console.error(e)}))}(e)}))}}))}function u(){Object(b.a)(s).then((function(e){return e.deleteFile()})).then((function(){G(s),window.plugins.toast.showShortBottom(strings.success),_(I)})).catch((function(e){console.log(e),d.a.error(e)}))}}function C(e){H(e,"contextmenu")}function P(){A={},_(I.url,I.name)}function J(e){var t=a.a.parse(c.a.render('<ul class="list" id="list" empty-msg="{{msg}}">{{#list}}\n  {{#.}}\n  <li tabindex="1" class="tile" url="{{nativeURL}}" origin="{{origin}}" {{#isDirectory}} action="folder" type="folder"\n    {{/isDirectory}} {{#canWrite}} can-write="true" {{/canWrite}} uuid="{{uuid}}" {{#isFile}} action="file" type="file"\n    {{/isFile}} name="{{name}}" {{#open-doc}} open-doc="true" {{/open-doc}}>\n    <span class="icon {{type}}"></span>\n    <div class="text">\n      <span>{{name}}</span>\n    </div>\n  </li>\n  {{/.}}\n  {{/list}}</ul>',{msg:strings["empty folder message"],list:e})),n=j.querySelector("#list");n&&n.remove(),j.append(t),t.focus()}function U(e,t){var n=B.querySelector('[url="'.concat(t,'"]')),r=B.querySelector(".active");if(r&&r.classList.remove("active"),n)return n.classList.add("active");n=a()("span",{className:"nav active",attr:{action:"navigation",url:t,text:e,name:e},tabIndex:-1}),B.append(n),B.scrollLeft=B.scrollWidth}function G(e){A[e]&&delete A[e],A[I.url]&&delete A[I.url];var t=!0,n=!1,r=void 0;try{for(var i,o=addedFolder[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;a.url===e?a.remove():new RegExp(e).test(I.url)&&a.reload()}}catch(e){n=!0,r=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw r}}}parseInt(device.version)<7?q():v.a.listExternalStorages().then((function(e){q(e)})),U.pop=function(){var e=B.lastChild;e&&e.remove()}}))}}}]);